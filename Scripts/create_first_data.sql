create table product_groups (
	group_id serial primary key,
	group_name VARCHAR(100),
	description	text,
	created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
)

insert into product_groups (group_name, description)
values
	('FILTERS', 'Фильтры'),
('ENGINE_PARTS', 'Детали двигателя'),
('EXLE_PARTS', 'Детали осей, мостов'),
('SUSPENSION', 'Подвеска'),
('TRANSMISSION', 'Трансмиссия'),
('BEARING', 'Подшипники'),
('GASKETS', 'Прокладки, уплотнения'),
('ELECTRONIC_COMP', 'Электронные компоненты'),
('COOLING_SYSTEM', 'Система охлаждения'),
('BODY_PARTS', 'Детали кузова'),
('ELECTRIC_PARTS', 'Электрические детали');

create table product_categories (
	category_id	serial primary key,
	category_name VARCHAR(100),
	group_id INT not null,
	description text,
	created_at timestamp default current_timestamp
)

insert into product_categories (category_id, category_name, group_id, description)
values
(1, 'BRAKE SYSTEM DETAILS', 1, 'Детали тормозной системы'),
(2, 'FILTERS_AIR', 2, 'Фильтры возд'),
(3, 'FILTERS_CAB', 2, 'Фильтры каб'),
(4, 'FILTERS_FUEL', 2, 'Фильтры топл'),
(5, 'FILTERS_OIL', 2, 'Фильтры '),
(6, 'ENGINE DETAILS ', 3, 'Детали двигателя '),
(7, 'OIL PUMPS ', 3, 'Насосы масляные '),
(8, 'AXLES TRAILERS', 4, 'Оси к прицепам и полуприцепам'),
(9, 'OTHER AXLES DETAILS', 4, 'Детали мостов прочие'),
(10, 'SHOCK ABSORBERS', 5, 'Амортизаторы'),
(11, 'SPRINGS', 5, 'Рессоры'),
(12, 'SUSPENSION AND STEERING DETAILS ', 5, 'Детали подвески и рулевого управления '),
(13, 'CLUTCHES ', 6, 'Сцепления '),
(14, 'GEARBOX DETAILS', 6, 'Детали КПП '),
(15, 'BEARINGS ROLLERS TENSIONERS ', 7, 'Подшипники, ролики, натяжители '),
(16, 'GASKETS AND SEALS ', 8, 'Прокладки и уплотнения '),
(17, 'SENSORS ', 9, 'Датчики '),
(18, 'FANS', 10, 'Вентиляторы'),
(19, 'RADIATORS ', 10, 'Радиаторы '),
(20, 'THERMOSTATS', 10, 'Термостаты'),
(21, 'WATER PUMPS', 10, 'Насосы водяные'),
(22, 'FASTENERS', 11, 'Крепёжные элементы'),
(23, 'GLASS', 11, 'Стёкла '),
(24, 'MIRRORS', 11, 'Зеркала'),
(25, 'OPTICS', 11, 'Оптика '),
(26, 'BATTERY', 12, 'АКБ'),
(27, 'ELECTRIC_MOTORS', 12, 'Электромоторы'),
(28, 'ELECTRICAL_EQUIPMENT_OTHER', 12, 'Электрооборудование прочее'),
(29, 'GENERATORS', 12, 'Генераторы'),
(30, 'GLOW_PLUGS', 12, 'Свечи накаливания'),
(31, 'IGNITION_COILS', 12, 'Распределители и катушки зажигания'),
(32, 'IGNITION_WIRES', 12, 'Провода зажигания'),
(33, 'LAMPS', 12, 'Лампы'),
(34, 'SOUND_ALARM_DEVICES', 12, 'Приборы звуковой сигнализации'),
(35, 'SPARK_PLUGS', 12, 'Свечи зажигания'),
(36, 'STARTERS', 12, 'Стартеры');

create table advertising (
	ad_id serial primary key,
	campaign_name varchar(100),
	description text,
	date_start	timestamp,
	date_end timestamp,
	cost_ad numeric(10,4)
)

create table ad_orders (
	ad_orders_id serial primary key,
	ad_id INTEGER,
	order_id integer
)

create table products (
product_id serial primary key,
product_name varchar(100),
category_id int not null,
supplier_id int not null,
price numeric(10,4) not null,
cost_price numeric(10,4) not null,
reorder_level integer not null,
reorder_quantity integer not null,
created_at timestamp default current_timestamp
)

-- 01/2017
insert into dw.products_dim (product_id, product_name, category_id, supplier_id, price, cost_price, reorder_level, reorder_quantity)
values
(412, 'Prod_412', 13, 12, 262.43, 219.35, 147, 98),
(413, 'Prod_413', 13, 12, 186.42, 158.04, 147, 98),
(414, 'Prod_414', 13, 12, 250.9, 212.03, 147, 98),
(415, 'Prod_415', 13, 12, 232.87, 195.18, 147, 98),
(416, 'Prod_416', 13, 12, 180.6, 157.73, 147, 98),
(417, 'Prod_417', 13, 12, 240.64, 208.38, 147, 98),
(418, 'Prod_418', 13, 12, 194.03, 165.44, 147, 98),
(419, 'Prod_419', 13, 12, 181.55, 154.88, 147, 98),
(420, 'Prod_420', 13, 12, 182.98, 156.45, 147, 98),
(421, 'Prod_421', 13, 12, 194.48, 169.54, 147, 98),
(422, 'Prod_422', 13, 12, 210, 178.25, 147, 98),
(423, 'Prod_423', 14, 13, 13.68, 11.64, 15, 9),
(424, 'Prod_424', 14, 13, 93.24, 80.95, 15, 9),
(425, 'Prod_425', 14, 13, 113.43, 98, 15, 9),
(426, 'Prod_426', 14, 13, 122.41, 103.57, 15, 9),
(427, 'Prod_427', 14, 13, 52.81, 44.46, 15, 9),
(428, 'Prod_428', 14, 13, 52.59, 45.19, 15, 9),
(429, 'Prod_429', 14, 13, 21.83, 18.93, 15, 9),
(430, 'Prod_430', 14, 13, 96.75, 83.69, 15, 9),
(431, 'Prod_431', 14, 13, 35.2, 30.37, 15, 9),
(432, 'Prod_432', 14, 13, 21.23, 17.91, 15, 9),
(433, 'Prod_433', 14, 13, 29.62, 24.92, 15, 9),
(434, 'Prod_434', 14, 13, 50.59, 42.7, 15, 9),
(435, 'Prod_435', 14, 13, 109.83, 95.14, 15, 9),
(436, 'Prod_436', 14, 13, 50.36, 43.61, 15, 9),
(437, 'Prod_437', 14, 13, 14.87, 12.61, 15, 9),
(438, 'Prod_438', 14, 13, 103.85, 87.58, 15, 9),
(439, 'Prod_439', 14, 13, 35.01, 29.49, 15, 9),
(440, 'Prod_440', 14, 13, 87.98, 76.01, 15, 9),
(441, 'Prod_441', 14, 13, 9.25, 7.98, 15, 9),
(442, 'Prod_442', 14, 13, 49.59, 42.96, 15, 9),
(443, 'Prod_443', 14, 13, 59.84, 50.67, 15, 9),
(444, 'Prod_444', 14, 13, 35.46, 30.73, 15, 9),
(445, 'Prod_445', 14, 13, 69.98, 60.55, 15, 9),
(446, 'Prod_446', 14, 14, 21.76, 18.4, 38, 18),
(447, 'Prod_447', 14, 14, 64.29, 54.8, 38, 18),
(448, 'Prod_448', 14, 14, 104.71, 90.56, 38, 18),
(449, 'Prod_449', 14, 14, 59.14, 51.35, 38, 18),
(450, 'Prod_450', 14, 14, 47.98, 41.11, 38, 18),
(451, 'Prod_451', 14, 14, 65.43, 55.9, 38, 18),
(452, 'Prod_452', 14, 14, 102.38, 88.22, 38, 18),
(453, 'Prod_453', 14, 14, 52.25, 44.94, 38, 18),
(454, 'Prod_454', 14, 14, 89.18, 75.92, 38, 18),
(455, 'Prod_455', 14, 14, 112.46, 97, 38, 18),
(456, 'Prod_456', 14, 14, 56.74, 48.14, 38, 18),
(457, 'Prod_457', 14, 14, 123.54, 104.55, 38, 18),
(458, 'Prod_458', 14, 14, 111.61, 97.03, 38, 18),
(459, 'Prod_459', 14, 14, 39.53, 33.96, 38, 18),
(460, 'Prod_460', 14, 14, 104.75, 88.67, 38, 18),
(461, 'Prod_461', 14, 14, 64.83, 54.84, 38, 18);

	select * 
	from dw.customers_dim
--where product_id > 410

-- 03/2017
insert into dw.products_dim (product_id, product_name, category_id, supplier_id, price, cost_price, reorder_level, reorder_quantity)
values
(462, 'Prod_462', 14, 14, 18.48, 15.54, 38, 18),
(463, 'Prod_463', 15, 16, 41.02, 34.35, 75, 47),
(464, 'Prod_464', 15, 16, 25.67, 21.73, 75, 47),
(465, 'Prod_465', 15, 16, 64.62, 54.01, 75, 47),
(466, 'Prod_466', 15, 16, 40.17, 32.84, 75, 47),
(467, 'Prod_467', 15, 16, 158.28, 128.86, 75, 47),
(468, 'Prod_468', 15, 16, 200.42, 165.77, 75, 47),
(469, 'Prod_469', 15, 16, 212.72, 175.35, 75, 47),
(470, 'Prod_470', 15, 16, 158.43, 134.02, 75, 47),
(471, 'Prod_471', 15, 16, 178.42, 152.22, 75, 47),
(472, 'Prod_472', 15, 16, 168.44, 138.86, 75, 47),
(473, 'Prod_473', 15, 16, 92.73, 77.92, 75, 47),
(474, 'Prod_474', 15, 16, 23.04, 18.97, 75, 47),
(475, 'Prod_475', 15, 16, 127.97, 103.28, 75, 47),
(476, 'Prod_476', 15, 16, 72.7, 59.54, 75, 47),
(477, 'Prod_477', 15, 16, 222.45, 188.34, 75, 47),
(478, 'Prod_478', 15, 16, 86.49, 70.46, 75, 47),
(479, 'Prod_479', 15, 16, 195.41, 165.28, 75, 47),
(480, 'Prod_480', 15, 16, 53.37, 44.62, 75, 47),
(481, 'Prod_481', 15, 16, 18.62, 15.22, 75, 47),
(482, 'Prod_482', 15, 16, 24.13, 19.92, 75, 47),
(483, 'Prod_483', 15, 16, 94.14, 78.92, 75, 47),
(484, 'Prod_484', 15, 16, 47.02, 39.03, 75, 47),
(485, 'Prod_485', 15, 16, 202.18, 166.2, 75, 47),
(486, 'Prod_486', 15, 16, 123.78, 102.28, 75, 47),
(487, 'Prod_487', 15, 16, 218.44, 184.32, 75, 47),
(488, 'Prod_488', 15, 16, 105.73, 89.93, 75, 47),
(489, 'Prod_489', 15, 16, 133.27, 110.16, 75, 47),
(490, 'Prod_490', 15, 16, 211.66, 177.55, 75, 47),
(491, 'Prod_491', 15, 16, 75.19, 63.95, 75, 47),
(492, 'Prod_492', 15, 16, 55.27, 46.33, 75, 47),
(493, 'Prod_493', 15, 16, 187.83, 158.13, 75, 47),
(494, 'Prod_494', 15, 16, 119.37, 96.61, 75, 47),
(495, 'Prod_495', 15, 16, 23.76, 19.24, 75, 47),
(496, 'Prod_496', 15, 16, 107.15, 87.37, 75, 47),
(497, 'Prod_497', 15, 16, 70.56, 59.96, 75, 47),
(498, 'Prod_498', 15, 16, 50.32, 41.91, 75, 47),
(499, 'Prod_499', 15, 16, 110.25, 89.97, 75, 47),
(500, 'Prod_500', 15, 16, 84.72, 69.88, 75, 47),
(501, 'Prod_501', 15, 16, 71.13, 57.36, 75, 47),
(502, 'Prod_502', 15, 16, 166.3, 139.68, 75, 47),
(503, 'Prod_503', 15, 16, 119.81, 100.93, 75, 47),
(504, 'Prod_504', 15, 16, 141.62, 119.1, 75, 47),
(505, 'Prod_505', 15, 16, 29.04, 24.66, 75, 47),
(506, 'Prod_506', 15, 16, 119.05, 97.25, 75, 47),
(507, 'Prod_507', 15, 16, 144.52, 120.58, 75, 47),
(508, 'Prod_508', 15, 16, 16.74, 14.29, 75, 47),
(509, 'Prod_509', 15, 16, 15.73, 13.19, 75, 47),
(510, 'Prod_510', 15, 16, 189.37, 159.58, 75, 47),
(511, 'Prod_511', 15, 16, 95.65, 79.81, 75, 47),
(512, 'Prod_512', 15, 16, 48.72, 40.95, 75, 47);

-- 05/2017
insert into dw.products_dim (product_id, product_name, category_id, supplier_id, price, cost_price, reorder_level, reorder_quantity)
values
(513, 'Prod_513', 16, 15, 14.3, 11.97, 18, 12),
(514, 'Prod_514', 16, 15, 13.36, 11.13, 18, 12),
(515, 'Prod_515', 16, 15, 10.09, 8.31, 18, 12),
(516, 'Prod_516', 16, 15, 8.15, 6.9, 18, 12),
(517, 'Prod_517', 16, 15, 13.32, 11.01, 18, 12),
(518, 'Prod_518', 16, 15, 8.97, 7.39, 18, 12),
(519, 'Prod_519', 16, 15, 3.62, 3.05, 18, 12),
(520, 'Prod_520', 16, 15, 6.06, 5.12, 18, 12),
(521, 'Prod_521', 16, 15, 13.35, 11.22, 18, 12),
(522, 'Prod_522', 16, 15, 14.24, 11.87, 18, 12),
(523, 'Prod_523', 16, 15, 10.69, 8.94, 18, 12),
(524, 'Prod_524', 16, 15, 12.19, 10.14, 18, 12),
(525, 'Prod_525', 16, 15, 2.59, 2.18, 18, 12),
(526, 'Prod_526', 16, 15, 7.65, 6.3, 18, 12),
(527, 'Prod_527', 16, 15, 12.12, 10.16, 18, 12),
(528, 'Prod_528', 16, 15, 12.87, 10.87, 18, 12),
(529, 'Prod_529', 16, 15, 13.62, 11.43, 18, 12),
(530, 'Prod_530', 16, 15, 8.21, 6.91, 18, 12),
(531, 'Prod_531', 16, 15, 6.41, 5.31, 18, 12),
(532, 'Prod_532', 16, 15, 8.32, 6.82, 18, 12),
(533, 'Prod_533', 16, 15, 8.88, 7.38, 18, 12),
(534, 'Prod_534', 16, 15, 9.61, 8.09, 18, 12),
(535, 'Prod_535', 16, 15, 13.21, 11.1, 18, 12),
(536, 'Prod_536', 16, 15, 13.92, 11.52, 18, 12),
(537, 'Prod_537', 16, 15, 5.47, 4.56, 18, 12),
(538, 'Prod_538', 16, 17, 7.48, 6.28, 35, 24),
(539, 'Prod_539', 16, 17, 5.67, 4.74, 35, 24),
(540, 'Prod_540', 16, 17, 7.55, 6.28, 35, 24),
(541, 'Prod_541', 16, 17, 9.96, 8.31, 35, 24),
(542, 'Prod_542', 16, 17, 6.27, 5.25, 35, 24),
(543, 'Prod_543', 16, 17, 11.76, 9.73, 35, 24),
(544, 'Prod_544', 16, 17, 5.82, 4.82, 35, 24),
(545, 'Prod_545', 16, 17, 13.7, 11.24, 35, 24),
(546, 'Prod_546', 16, 17, 6.52, 5.38, 35, 24),
(547, 'Prod_547', 16, 17, 6.51, 5.41, 35, 24),
(548, 'Prod_548', 16, 17, 4.28, 3.54, 35, 24),
(549, 'Prod_549', 16, 17, 2.82, 2.33, 35, 24),
(550, 'Prod_550', 16, 17, 12.21, 10.03, 35, 24),
(551, 'Prod_551', 16, 17, 4.26, 3.53, 35, 24),
(552, 'Prod_552', 16, 17, 5.52, 4.61, 35, 24),
(553, 'Prod_553', 16, 17, 12.04, 10.15, 35, 24),
(554, 'Prod_554', 16, 17, 4.48, 3.69, 35, 24),
(555, 'Prod_555', 16, 17, 4.23, 3.52, 35, 24),
(556, 'Prod_556', 16, 17, 11.09, 9.17, 35, 24),
(557, 'Prod_557', 16, 17, 6.63, 5.56, 35, 24),
(558, 'Prod_558', 16, 17, 8.23, 6.89, 35, 24),
(559, 'Prod_559', 16, 17, 13.01, 10.85, 35, 24),
(560, 'Prod_560', 16, 17, 12.57, 10.47, 35, 24),
(561, 'Prod_561', 16, 17, 8.08, 6.74, 35, 24),
(562, 'Prod_562', 16, 17, 13.27, 11.17, 35, 24),
(563, 'Prod_563', 16, 17, 7.02, 5.92, 35, 24),
(564, 'Prod_564', 16, 17, 2.86, 2.41, 35, 24),
(565, 'Prod_565', 16, 17, 12.53, 10.48, 35, 24),
(566, 'Prod_566', 16, 17, 6.33, 5.31, 35, 24),
(567, 'Prod_567', 16, 17, 12.19, 10.25, 35, 24),
(568, 'Prod_568', 16, 17, 3.36, 2.84, 35, 24),
(569, 'Prod_569', 16, 17, 10.66, 9.01, 35, 24),
(570, 'Prod_570', 16, 17, 5.58, 4.67, 35, 24),
(571, 'Prod_571', 16, 17, 8.77, 7.22, 35, 24),
(572, 'Prod_572', 16, 17, 2.83, 2.38, 35, 24),
(573, 'Prod_573', 16, 17, 9.15, 7.62, 35, 24),
(574, 'Prod_574', 16, 17, 8.29, 6.97, 35, 24),
(575, 'Prod_575', 16, 17, 6.31, 5.25, 35, 24),
(576, 'Prod_576', 16, 17, 12.89, 10.75, 35, 24),
(577, 'Prod_577', 16, 17, 13.14, 11.07, 35, 24),
(578, 'Prod_578', 16, 17, 11.1, 9.12, 35, 24),
(579, 'Prod_579', 16, 17, 9.68, 8.1, 35, 24),
(580, 'Prod_580', 16, 17, 10.71, 8.91, 35, 24),
(581, 'Prod_581', 16, 17, 10.59, 8.85, 35, 24),
(582, 'Prod_582', 16, 17, 7.47, 6.31, 35, 24),
(583, 'Prod_583', 16, 17, 13.63, 11.32, 35, 24),
(584, 'Prod_584', 16, 17, 11.66, 9.66, 35, 24),
(585, 'Prod_585', 16, 17, 4.17, 3.5, 35, 24),
(586, 'Prod_586', 16, 17, 7.6, 6.41, 35, 24),
(587, 'Prod_587', 16, 17, 8.92, 7.52, 35, 24),
(588, 'Prod_588', 16, 17, 6.39, 5.27, 35, 24),
(589, 'Prod_589', 16, 17, 13.56, 11.21, 35, 24),
(590, 'Prod_590', 16, 17, 3.36, 2.8, 35, 24),
(591, 'Prod_591', 16, 17, 4.44, 3.67, 35, 24),
(592, 'Prod_592', 16, 17, 7.74, 6.46, 35, 24),
(593, 'Prod_593', 16, 17, 5.34, 4.4, 35, 24),
(594, 'Prod_594', 16, 17, 3.42, 2.88, 35, 24),
(595, 'Prod_595', 16, 17, 2.67, 2.26, 35, 24);

-- 07/2017
insert into dw.products_dim (product_id, product_name, category_id, supplier_id, price, cost_price, reorder_level, reorder_quantity)
values
(596, 'Prod_596', 16, 18, 6.83, 5.63, 42, 24),
(597, 'Prod_597', 16, 18, 6.58, 5.54, 42, 24),
(598, 'Prod_598', 16, 18, 9.08, 7.57, 42, 24),
(599, 'Prod_599', 16, 18, 10.99, 9.06, 42, 24),
(600, 'Prod_600', 16, 18, 2.72, 2.27, 42, 24),
(601, 'Prod_601', 16, 18, 13.74, 11.52, 42, 24),
(602, 'Prod_602', 16, 18, 4.51, 3.79, 42, 24),
(603, 'Prod_603', 16, 18, 2.72, 2.28, 42, 24),
(604, 'Prod_604', 16, 18, 12.41, 10.2, 42, 24),
(605, 'Prod_605', 16, 18, 11.13, 9.4, 42, 24),
(606, 'Prod_606', 16, 18, 9.16, 7.59, 42, 24),
(607, 'Prod_607', 16, 18, 4.53, 3.75, 42, 24),
(608, 'Prod_608', 16, 18, 12.75, 10.67, 42, 24),
(609, 'Prod_609', 16, 18, 10.35, 8.57, 42, 24),
(610, 'Prod_610', 16, 18, 2.57, 2.12, 42, 24),
(611, 'Prod_611', 16, 18, 10.31, 8.49, 42, 24),
(612, 'Prod_612', 16, 18, 9.86, 8.23, 42, 24),
(613, 'Prod_613', 17, 19, 41.95, 35.03, 234, 187),
(614, 'Prod_614', 17, 19, 20.23, 17.04, 234, 187),
(615, 'Prod_615', 17, 19, 18.04, 15.58, 234, 187),
(616, 'Prod_616', 17, 19, 31.16, 26.97, 234, 187),
(617, 'Prod_617', 17, 19, 36.49, 30.81, 234, 187),
(618, 'Prod_618', 17, 19, 22.79, 19.48, 234, 187),
(619, 'Prod_619', 17, 19, 30.06, 25.39, 234, 187),
(620, 'Prod_620', 17, 19, 25.27, 21.73, 234, 187),
(621, 'Prod_621', 17, 19, 36.06, 30.97, 234, 187),
(622, 'Prod_622', 17, 19, 35.24, 30.61, 234, 187),
(623, 'Prod_623', 17, 19, 21.88, 18.93, 234, 187),
(624, 'Prod_624', 17, 19, 18.2, 15.8, 234, 187),
(625, 'Prod_625', 17, 19, 16.46, 14.03, 234, 187),
(626, 'Prod_626', 17, 19, 21.99, 18.34, 234, 187),
(627, 'Prod_627', 17, 19, 12.43, 10.51, 234, 187),
(628, 'Prod_628', 17, 19, 15.23, 12.85, 234, 187),
(629, 'Prod_629', 17, 19, 30.37, 25.44, 234, 187),
(630, 'Prod_630', 17, 19, 16.08, 13.91, 234, 187),
(631, 'Prod_631', 17, 19, 31.66, 27.37, 234, 187),
(632, 'Prod_632', 17, 19, 31.09, 26.93, 234, 187),
(633, 'Prod_633', 17, 19, 18.59, 15.55, 234, 187),
(634, 'Prod_634', 17, 19, 18.45, 15.7, 234, 187),
(635, 'Prod_635', 17, 19, 37.9, 32.07, 234, 187),
(636, 'Prod_636', 17, 19, 12, 10.25, 234, 187),
(637, 'Prod_637', 17, 19, 13.55, 11.36, 234, 187),
(638, 'Prod_638', 18, 20, 18.52, 15.15, 72, 47),
(639, 'Prod_639', 18, 20, 21.66, 17.95, 72, 47),
(640, 'Prod_640', 18, 20, 20.48, 16.76, 72, 47),
(641, 'Prod_641', 18, 20, 20.59, 16.74, 72, 47),
(642, 'Prod_642', 18, 20, 18.96, 15.39, 72, 47),
(643, 'Prod_643', 18, 20, 21.89, 17.87, 72, 47),
(644, 'Prod_644', 18, 20, 21.7, 17.97, 72, 47),
(645, 'Prod_645', 18, 20, 22.65, 18.53, 72, 47),
(646, 'Prod_646', 18, 20, 22.13, 17.97, 72, 47),
(647, 'Prod_647', 18, 20, 21.8, 18.05, 72, 47),
(648, 'Prod_648', 19, 20, 91.17, 78.62, 30, 20),
(649, 'Prod_649', 19, 20, 70.73, 61.28, 30, 20),
(650, 'Prod_650', 19, 20, 88.42, 77.42, 30, 20),
(651, 'Prod_651', 19, 20, 82.39, 71.78, 30, 20),
(652, 'Prod_652', 19, 20, 70.83, 61.62, 30, 20),
(653, 'Prod_653', 19, 20, 85.29, 74.57, 30, 20),
(654, 'Prod_654', 19, 20, 81.69, 70.9, 30, 20),
(655, 'Prod_655', 19, 20, 88.16, 77.37, 30, 20),
(656, 'Prod_656', 19, 20, 93.33, 79.94, 30, 20),
(657, 'Prod_657', 19, 20, 79.78, 69.39, 30, 20),
(658, 'Prod_658', 19, 20, 71.83, 62.15, 30, 20),
(659, 'Prod_659', 19, 20, 79.8, 70.06, 30, 20),
(660, 'Prod_660', 19, 20, 82.16, 71.46, 30, 20),
(661, 'Prod_661', 19, 20, 84.2, 74.1, 30, 20),
(662, 'Prod_662', 19, 20, 68.92, 60.8, 30, 20),
(663, 'Prod_663', 19, 20, 78.3, 67.9, 30, 20),
(664, 'Prod_664', 19, 21, 91.01, 78.53, 20, 10),
(665, 'Prod_665', 19, 21, 87.48, 75.12, 20, 10),
(666, 'Prod_666', 19, 21, 88.42, 75.68, 20, 10),
(667, 'Prod_667', 19, 21, 69.9, 60.21, 20, 10),
(668, 'Prod_668', 19, 21, 88.83, 76.67, 20, 10),
(669, 'Prod_669', 19, 21, 84.18, 72.72, 20, 10),
(670, 'Prod_670', 19, 21, 77.32, 68.15, 20, 10),
(671, 'Prod_671', 19, 21, 90.75, 78.08, 20, 10),
(672, 'Prod_672', 19, 21, 72.5, 62.58, 20, 10),
(673, 'Prod_673', 19, 21, 76.6, 66.3, 20, 10),
(674, 'Prod_674', 19, 21, 82.39, 72.87, 20, 10),
(675, 'Prod_675', 19, 21, 85.95, 73.64, 20, 10),
(676, 'Prod_676', 19, 21, 85.59, 73.24, 20, 10),
(677, 'Prod_677', 19, 21, 73.85, 64.95, 20, 10);

-- 09/2017
insert into dw.products_dim (product_id, product_name, category_id, supplier_id, price, cost_price, reorder_level, reorder_quantity)
values
(678, 'Prod_678', 20, 22, 9.27, 7.72, 112, 78),
(679, 'Prod_679', 20, 22, 14.14, 11.74, 112, 78),
(680, 'Prod_680', 20, 22, 15.5, 12.82, 112, 78),
(681, 'Prod_681', 20, 22, 12.47, 10.17, 112, 78),
(682, 'Prod_682', 20, 22, 10.4, 8.53, 112, 78),
(683, 'Prod_683', 20, 22, 14.69, 12.27, 112, 78),
(684, 'Prod_684', 20, 22, 6.74, 5.64, 112, 78),
(685, 'Prod_685', 20, 22, 17.98, 14.62, 112, 78),
(686, 'Prod_686', 20, 22, 13.66, 11.17, 112, 78),
(687, 'Prod_687', 20, 22, 17.07, 13.98, 112, 78),
(688, 'Prod_688', 20, 22, 9.66, 7.96, 112, 78),
(689, 'Prod_689', 20, 22, 6.23, 5.31, 112, 78),
(690, 'Prod_690', 20, 22, 16.42, 13.84, 112, 78),
(691, 'Prod_691', 20, 22, 13.6, 11.58, 112, 78),
(692, 'Prod_692', 20, 22, 7.58, 6.28, 112, 78),
(693, 'Prod_693', 21, 22, 46.03, 39.76, 22, 16),
(694, 'Prod_694', 21, 22, 31.01, 26.59, 22, 16),
(695, 'Prod_695', 21, 22, 41.07, 35.68, 22, 16),
(696, 'Prod_696', 21, 22, 32.34, 27.42, 22, 16),
(697, 'Prod_697', 21, 22, 49.64, 41.94, 22, 16),
(698, 'Prod_698', 21, 22, 29.88, 25.66, 22, 16),
(699, 'Prod_699', 21, 22, 31.21, 26.29, 22, 16),
(700, 'Prod_700', 21, 22, 41.5, 35.81, 22, 16),
(701, 'Prod_701', 21, 22, 33.49, 28.68, 22, 16),
(702, 'Prod_702', 21, 22, 50.39, 42.5, 22, 16),
(703, 'Prod_703', 21, 22, 38.71, 33.06, 22, 16),
(704, 'Prod_704', 21, 22, 43.49, 37.53, 22, 16),
(705, 'Prod_705', 21, 22, 45.55, 38.9, 22, 16),
(706, 'Prod_706', 21, 22, 48.89, 42.11, 22, 16),
(707, 'Prod_707', 21, 22, 40.55, 34.26, 22, 16),
(708, 'Prod_708', 21, 22, 42.87, 37.24, 22, 16),
(709, 'Prod_709', 21, 22, 48.68, 41.65, 22, 16),
(710, 'Prod_710', 21, 22, 35.71, 30.67, 22, 16),
(711, 'Prod_711', 21, 22, 32.46, 28.02, 22, 16),
(712, 'Prod_712', 21, 22, 34.88, 29.66, 22, 16),
(713, 'Prod_713', 21, 22, 35.85, 30.86, 22, 16),
(714, 'Prod_714', 21, 22, 50.24, 43.29, 22, 16),
(715, 'Prod_715', 21, 22, 48.06, 40.46, 22, 16),
(716, 'Prod_716', 21, 22, 46.29, 40.04, 22, 16),
(717, 'Prod_717', 21, 22, 50.78, 43.3, 22, 16),
(718, 'Prod_718', 21, 22, 38.79, 33.27, 22, 16),
(719, 'Prod_719', 21, 22, 42.85, 36.9, 22, 16),
(720, 'Prod_720', 21, 22, 31.65, 27.4, 22, 16),
(721, 'Prod_721', 21, 22, 48.96, 41.69, 22, 16),
(722, 'Prod_722', 21, 22, 41.39, 35.48, 22, 16);



create table suppliers (
supplier_id serial primary key,
supplier_name varchar(100) not null,
email varchar(100),
city varchar(100) not null,
country varchar(100) not null,
lead_time Integer not null,
delay_time integer not null,
delivery_cycle integer not null,
created_at timestamp default current_timestamp
)

create table customers(
customer_id serial primary key,
customer_name varchar(100) not null,
email varchar(100),
address text,
city varchar(100) not null,
country varchar(100) not null,
created_at timestamp default current_timestamp
)


insert into dw.geo_dim (geo_id, city, country)
values
(28, 'Sofia', 'Bulgaria'),
(29, 'Zagreb', 'Croatia'),
(30, 'Nicosia', 'Cyprus'),
(31, 'Prague', 'Czech Republic'),
(32, 'Copenhagen', 'Denmark'),
(33, 'Tallinn', 'Estonia'),
(34, 'Helsinki', 'Finland'),
(35, 'Athens', 'Greece'),
(36, 'Budapest', 'Hungary'),
(37, 'Riga', 'Latvia'),
(38, 'Vilnius', 'Lithuania'),
(39, 'Podgorica', 'Montenegro'),
(40, 'Lisbon', 'Portugal'),
(41, 'Bucharest', 'Romania'),
(42, 'Belgrade', 'Serbia'),
(43, 'Bratislava', 'Slovakia'),
(44, 'Ljubljana', 'Slovenia');


select * 
from dw.geo_dim

insert into dw.customers_dim (customer_id, customer_name, geo_id)
values
(501, 'Customer_501', 29),
(502, 'Customer_502', 28),
(503, 'Customer_503', 28),
(504, 'Customer_504', 32),
(505, 'Customer_505', 30),
(506, 'Customer_506', 29),
(507, 'Customer_507', 31),
(508, 'Customer_508', 32),
(509, 'Customer_509', 29),
(510, 'Customer_510', 32),
(511, 'Customer_511', 29),
(512, 'Customer_512', 28),
(513, 'Customer_513', 30),
(514, 'Customer_514', 30),
(515, 'Customer_515', 29),
(516, 'Customer_516', 29),
(517, 'Customer_517', 29),
(518, 'Customer_518', 28),
(519, 'Customer_519', 28),
(520, 'Customer_520', 29),
(521, 'Customer_521', 28),
(522, 'Customer_522', 31),
(523, 'Customer_523', 30),
(524, 'Customer_524', 31),
(525, 'Customer_525', 31),
(526, 'Customer_526', 32),
(527, 'Customer_527', 31),
(528, 'Customer_528', 28),
(529, 'Customer_529', 32),
(530, 'Customer_530', 32),
(531, 'Customer_531', 29),
(532, 'Customer_532', 30),
(533, 'Customer_533', 30),
(534, 'Customer_534', 32),
(535, 'Customer_535', 30),
(536, 'Customer_536', 31),
(537, 'Customer_537', 32),
(538, 'Customer_538', 31),
(539, 'Customer_539', 30),
(540, 'Customer_540', 28),
(541, 'Customer_541', 31),
(542, 'Customer_542', 32),
(543, 'Customer_543', 29),
(544, 'Customer_544', 30),
(545, 'Customer_545', 30),
(546, 'Customer_546', 28),
(547, 'Customer_547', 28),
(548, 'Customer_548', 32),
(549, 'Customer_549', 31),
(550, 'Customer_550', 31);

select *
from dw.customers_dim 

create table inventory(
inventory_id serial primary key,
product_id Integer not null,
quantity integer not null,
cost_price_amount numeric(10,4),
created_at timestamp default current_timestamp
)

insert into inventory(product_id,quantity,cost_price_amount)
values
(1, 94, 3139.6),
(2, 94, 2788.98),
(3, 94, 2322.74),
(4, 187, 7416.42),
(5, 94, 3056.88),
(6, 187, 5572.6),
(7, 187, 4925.58),
(8, 187, 3945.7),
(9, 187, 4482.39),
(10, 187, 3822.28),
(11, 94, 2538.94),
(12, 187, 5937.25),
(13, 187, 7364.06),
(14, 94, 3677.28),
(15, 187, 4315.96),
(16, 187, 6488.9),
(17, 187, 4878.83),
(18, 187, 4774.11),
(19, 187, 4200.02),
(20, 94, 3446.04),
(21, 187, 5912.94),
(22, 94, 3755.3),
(23, 187, 6481.42),
(24, 187, 5015.34),
(25, 94, 2235.32),
(26, 187, 6834.85),
(27, 187, 4789.07),
(28, 94, 2340.6),
(29, 187, 5976.52),
(30, 94, 2231.56),
(31, 187, 7459.43),
(32, 187, 6178.48),
(33, 94, 2927.16),
(34, 187, 5768.95),
(35, 187, 6271.98),
(36, 187, 5593.17),
(37, 187, 6754.44),
(38, 94, 1949.56),
(39, 187, 5451.05),
(40, 94, 3749.66),
(41, 187, 5931.64),
(42, 94, 3091.66),
(43, 94, 2535.18),
(44, 94, 2509.8),
(45, 94, 2762.66),
(46, 187, 4994.77),
(47, 94, 3149),
(48, 94, 2166.7),
(49, 94, 2376.32),
(50, 94, 2887.68),
(51, 187, 3846.59),
(52, 54, 1412.1),
(53, 187, 4519.79),
(54, 54, 1086.48),
(55, 187, 3998.06),
(56, 187, 5088.27),
(57, 187, 4325.31),
(58, 54, 856.44),
(59, 47, 1336.68),
(60, 54, 1172.34),
(61, 187, 5172.42),
(62, 187, 4762.89),
(63, 54, 1168.56),
(64, 187, 4181.32),
(65, 47, 1176.88),
(66, 54, 1212.84),
(67, 54, 824.58),
(68, 187, 5187.38),
(69, 187, 3736.26),
(70, 54, 1441.8),
(71, 47, 1247.85),
(72, 187, 3115.42),
(73, 47, 933.89),
(74, 187, 4701.18),
(75, 47, 1344.67),
(76, 187, 2960.21),
(77, 187, 2848.01),
(78, 54, 1376.46),
(79, 187, 3197.7),
(80, 47, 865.74),
(81, 187, 4916.23),
(82, 187, 4783.46),
(83, 187, 2977.04),
(84, 187, 4473.04),
(85, 54, 1595.16),
(86, 54, 1249.56),
(87, 54, 1072.98),
(88, 187, 5333.24),
(89, 187, 4157.01),
(90, 47, 1039.64),
(91, 54, 1519.56),
(92, 187, 4564.67),
(93, 187, 5458.53),
(94, 187, 5308.93),
(95, 187, 4001.8),
(96, 187, 4611.42),
(97, 187, 3833.5),
(98, 187, 3889.6),
(99, 187, 4207.5),
(100, 187, 3949.44),
(101, 134, 509.2),
(102, 468, 2171.52),
(103, 134, 778.54),
(104, 468, 1731.6),
(105, 468, 987.48),
(106, 468, 1558.44),
(107, 468, 996.84),
(108, 134, 629.8),
(109, 468, 1544.4),
(110, 117, 641.16),
(111, 468, 2485.08),
(112, 134, 375.2),
(113, 468, 1137.24),
(114, 468, 2087.28),
(115, 117, 234),
(116, 468, 1581.84),
(117, 117, 634.14),
(118, 468, 1506.96),
(119, 117, 335.79),
(120, 468, 1876.68),
(121, 89, 1087.58),
(122, 312, 4564.56),
(123, 312, 4318.08),
(124, 312, 3946.8),
(125, 78, 928.2),
(126, 312, 3260.4),
(127, 89, 1221.97),
(128, 312, 3921.84),
(129, 78, 921.18),
(130, 312, 3422.64),
(131, 312, 4555.2),
(132, 89, 1042.19),
(133, 312, 3260.4),
(134, 78, 811.2),
(135, 89, 981.67),
(136, 78, 978.12),
(137, 78, 1046.76),
(138, 312, 4112.16),
(139, 89, 1188.15),
(140, 89, 924.71),
(141, 78, 911.82),
(142, 312, 4589.52),
(143, 89, 918.48),
(144, 312, 4474.08),
(145, 78, 902.46),
(146, 78, 850.98),
(147, 312, 3506.88),
(148, 89, 1284.27),
(149, 78, 879.84),
(150, 312, 3394.56),
(151, 312, 3881.28),
(152, 312, 4424.16),
(153, 89, 1295.84),
(154, 312, 4361.76),
(155, 312, 3531.84),
(156, 78, 969.54),
(157, 78, 1060.8),
(158, 312, 4246.32),
(159, 78, 819.78),
(160, 89, 1249.56),
(161, 78, 951.6),
(162, 78, 1131),
(163, 312, 4676.88),
(164, 312, 3553.68),
(165, 312, 3291.6),
(166, 89, 965.65),
(167, 312, 3666),
(168, 78, 1132.56),
(169, 78, 1159.86),
(170, 89, 1134.75),
(171, 89, 1018.16),
(172, 89, 1175.69),
(173, 312, 3541.2),
(174, 312, 4296.24),
(175, 312, 3247.92),
(176, 312, 4470.96),
(177, 312, 3553.68),
(178, 312, 3385.2),
(179, 312, 3372.72),
(180, 312, 4633.2),
(181, 375, 5520),
(182, 107, 1632.82),
(183, 375, 7177.5),
(184, 107, 1380.3),
(185, 94, 1658.16),
(186, 375, 7252.5),
(187, 94, 1220.12),
(188, 94, 2312.4),
(189, 375, 9176.25),
(190, 107, 1193.05),
(191, 107, 2492.03),
(192, 107, 1627.47),
(193, 375, 6532.5),
(194, 375, 7968.75),
(195, 375, 3937.5),
(196, 94, 1232.34),
(197, 375, 7218.75),
(198, 375, 5182.5),
(199, 375, 7803.75),
(200, 375, 4413.75),
(201, 107, 1522.61),
(202, 94, 2079.28),
(203, 375, 5786.25),
(204, 107, 1728.05),
(205, 375, 8741.25),
(206, 94, 1251.14),
(207, 375, 8550),
(208, 375, 7702.5),
(209, 375, 6708.75),
(210, 107, 1387.79),
(211, 94, 1716.44),
(212, 107, 2214.9),
(213, 94, 1618.68),
(214, 375, 7425),
(215, 375, 7545),
(216, 94, 1125.18),
(217, 375, 6832.5),
(218, 94, 2218.4),
(219, 107, 1112.8),
(220, 375, 8347.5),
(221, 375, 5793.75),
(222, 107, 2036.21),
(223, 375, 4590),
(224, 107, 1458.41),
(225, 107, 1361.04),
(226, 375, 8887.5),
(227, 375, 7301.25),
(228, 94, 1295.32),
(229, 94, 2229.68),
(230, 94, 2010.66),
(231, 156, 8188.44),
(232, 156, 10990.2),
(233, 156, 8597.16),
(234, 156, 12359.88),
(235, 156, 7583.16),
(236, 156, 9402.12),
(237, 156, 8973.12),
(238, 156, 7600.32),
(239, 156, 11222.64),
(240, 156, 8450.52),
(241, 156, 7614.36),
(242, 156, 11350.56),
(243, 156, 10899.72),
(244, 156, 4196.4),
(245, 156, 6709.56),
(246, 156, 4444.44),
(247, 156, 5890.56),
(248, 156, 7555.08),
(249, 156, 11107.2),
(250, 156, 10742.16),
(251, 156, 4212),
(252, 156, 12798.24),
(253, 156, 11158.68),
(254, 156, 12640.68),
(255, 156, 10272.6),
(256, 156, 13022.88),
(257, 156, 4625.4),
(258, 156, 9938.76),
(259, 156, 9211.8),
(260, 156, 10313.16),
(261, 234, 7869.42),
(262, 234, 3807.18),
(263, 234, 5714.28),
(264, 234, 6825.78),
(265, 234, 4165.2),
(266, 12, 7759.2),
(267, 12, 5886),
(268, 12, 6282.24),
(269, 12, 6637.32),
(270, 12, 6844.92),
(271, 1561, 72633.33),
(272, 1561, 39618.18),
(273, 1561, 42256.27),
(274, 1561, 56492.59),
(275, 1561, 65031.26),
(276, 1561, 72805.04),
(277, 1561, 33951.75),
(278, 1561, 47750.99),
(279, 1561, 63080.01),
(280, 1561, 46392.92),
(281, 1561, 34154.68),
(282, 1561, 32843.44),
(283, 1561, 36730.33),
(284, 1561, 66061.52),
(285, 1561, 50014.44),
(286, 1561, 30033.64),
(287, 1561, 33452.23),
(288, 1561, 56196),
(289, 1561, 48312.95),
(290, 1561, 48078.8),
(291, 1561, 9740.64),
(292, 1561, 47829.04),
(293, 1561, 72664.55),
(294, 1561, 51153.97),
(295, 1561, 76145.58),
(296, 1561, 10302.6),
(297, 1561, 61097.54),
(298, 1561, 74693.85),
(299, 1561, 61347.3),
(300, 1561, 36995.7),
(301, 328, 5904),
(302, 328, 4536.24),
(303, 328, 11289.76),
(304, 328, 4503.44),
(305, 328, 6635.44),
(306, 328, 2476.4),
(307, 328, 14169.6),
(308, 328, 5494),
(309, 328, 6658.4),
(310, 328, 2381.28),
(311, 328, 12372.16),
(312, 328, 2427.2),
(313, 328, 6514.08),
(314, 328, 10384.48),
(315, 328, 13749.76),
(316, 328, 13776),
(317, 328, 4365.68),
(318, 328, 11102.8),
(319, 328, 3850.72),
(320, 328, 10945.36),
(321, 328, 4844.56),
(322, 328, 8600.16),
(323, 328, 9600.56),
(324, 328, 5412),
(325, 328, 3194.72),
(326, 328, 5785.92),
(327, 328, 13861.28),
(328, 328, 13280.72),
(329, 328, 2896.24),
(330, 328, 2788),
(331, 328, 13087.2),
(332, 328, 11801.44),
(333, 328, 13398.8),
(334, 328, 7580.08),
(335, 328, 11070),
(336, 328, 3945.84),
(337, 328, 8108.16),
(338, 328, 12352.48),
(339, 328, 9321.76),
(340, 328, 11306.16),
(341, 328, 7294.72),
(342, 328, 11063.44),
(343, 328, 13202),
(344, 328, 4992.16),
(345, 328, 4565.76),
(346, 328, 13598.88),
(347, 328, 13044.56),
(348, 328, 12687.04),
(349, 328, 7360.32),
(350, 328, 14651.76),
(351, 624, 38126.4),
(352, 624, 34057.92),
(353, 624, 55467.36),
(354, 624, 53826.24),
(355, 624, 52166.4),
(356, 624, 54456.48),
(357, 624, 43942.08),
(358, 624, 47442.72),
(359, 624, 44129.28),
(360, 624, 46076.16),
(361, 624, 49239.84),
(362, 624, 44503.68),
(363, 624, 46020),
(364, 624, 39068.64),
(365, 624, 36241.92),
(366, 781, 37816.02),
(367, 781, 22656.81),
(368, 781, 70375.91),
(369, 781, 17720.89),
(370, 781, 24328.15),
(371, 781, 61113.25),
(372, 781, 42814.42),
(373, 781, 36972.54),
(374, 781, 34364),
(375, 781, 16877.41),
(376, 781, 16354.14),
(377, 781, 37042.83),
(378, 781, 56552.21),
(379, 781, 45555.73),
(380, 781, 17877.09),
(381, 781, 27420.91),
(382, 781, 9840.6),
(383, 781, 7528.84),
(384, 781, 74991.62),
(385, 781, 62269.13),
(386, 781, 57801.81),
(387, 781, 5092.12),
(388, 781, 16822.74),
(389, 781, 28061.33),
(390, 781, 47117.73),
(391, 781, 69204.41),
(392, 781, 26803.92),
(393, 781, 17955.19),
(394, 781, 22789.58),
(395, 781, 41557.01),
(396, 781, 53623.46),
(397, 781, 21321.3),
(398, 781, 61722.43),
(399, 781, 30544.91),
(400, 781, 53459.45),
(401, 781, 34715.45),
(402, 781, 43767.24),
(403, 781, 18431.6),
(404, 781, 26710.2),
(405, 781, 31310.29),
(406, 781, 41228.99),
(407, 781, 56403.82),
(408, 781, 35160.62),
(409, 781, 61800.53),
(410, 781, 8981.5);

drop table if exists daily_inventory

create table daily_inventory(
daily_inventory_id serial primary key,
product_id integer not null,
quantity integer not null,
cost_price_amount numeric(10,4),
inventory_date timestamp default current_timestamp
)

insert into daily_inventory (product_id, quantity, cost_price_amount)
select product_id, quantity, cost_price_amount from inventory

select * from daily_inventory di 


create table orders(
order_id serial primary key,
customer_id integer not null,
order_date timestamp default current_timestamp,
total_amount numeric(10,4),
total_cogs numeric(10,4),
total_profit numeric(10,4),
operating_expenses numeric(10,4)
);

create table order_items(
order_item_id serial primary key,
order_id integer not null,
product_id integer not null,
quantity integer not null,
price numeric(10,4) not null,
cost_price numeric(10,4) not null
)

create table replenishment_orders(
replenishment_order_id serial primary key,
product_id integer not null,
supplier_id integer not null,
order_date timestamp default current_timestamp,
delivery_date timestamp not null,
quantity integer not null,
cost_price numeric(10,4),
status text
)

